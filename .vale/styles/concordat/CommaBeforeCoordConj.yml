# Flag missing commas before coordinating conjunctions that introduce a
# second independent clause. Focus on FANBOYS joins with an explicit subject
# and finite verb on the right.
extends: existence
level: warning
ignorecase: true
link: https://www.chicagomanualofstyle.org/qanda/data/faq/topics/Commas/faq0026.html
message: "Add a comma before the coordinating conjunction: \"%s\" joins two independent clauses."

scope:
  - sentence
  - ~heading
  - ~list

raw: '(?:^|[^-,;:–—])[[:space:]]+(for|and|nor|but|or|yet|so)\b(?:[[:space:]]+(?!\b(?:for|and|nor|but|or|yet|so)\b)[^[:space:],;:.!?]+){0,3}[[:space:]]+(?:I|you|he|she|it|we|they|this|that|these|those|there|the|a|an|[A-Z][A-Za-z0-9_-]+|[0-9]+)(?:[[:space:]]+(?!\b(?:for|and|nor|but|or|yet|so)\b)[^[:space:],;:.!?]+){0,3}[[:space:]]+\b(?:is|are|was|were|do|does|did|has|have|had|can|could|may|might|must|shall|should|will|would|continues?|continue|remains?|remain|becomes?|become)\b'

action:
  name: edit
  params:
    - regex
    - '([^-,;:–—[:space:]])[[:space:]]+(for|and|nor|but|or|yet|so)\b'
    - '$1, $2'
